{% extends "base.html" %}
{% load static %}
{% block head_title %}
  Hunt Completed
{% endblock head_title %}
{% block head %}
  <style>
@keyframes float {
  0% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
  100% { transform: translateY(0px); }
}

@keyframes glow {
  0%, 100% { filter: drop-shadow(0 0 15px rgba(8, 183, 79, 0.6)); }
  50% { filter: drop-shadow(0 0 30px rgba(8, 183, 79, 0.8)); }
}

.celebration-video {
  animation: float 6s ease-in-out infinite;
}

.text-gradient {
  background: linear-gradient(to right, #08B74F, #fec84b);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: glow 2s ease-in-out infinite;
}

/* Stats card */
.stats-card {
  border: 3px solid #08b74f;
  border-radius: 4px;
  background: linear-gradient(180deg, #2d1d0e 0%, #251809 100%);
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.1),
    0 4px 0 rgba(8, 183, 79, 0.3);
  transition: all 0.3s ease;
}

.stats-card:hover {
  transform: translateY(-2px);
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.15),
    0 6px 0 rgba(8, 183, 79, 0.4),
    0 8px 25px rgba(8, 183, 79, 0.15);
}

.stats-card-secondary {
  border-color: #f07a1a;
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.1),
    0 4px 0 rgba(240, 122, 26, 0.3);
}

.stats-card-secondary:hover {
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.15),
    0 6px 0 rgba(240, 122, 26, 0.4),
    0 8px 25px rgba(240, 122, 26, 0.15);
}
/* ===== MAX RETRO ARCADE STAR ===== */

.retro-star-wrapper {
  position: relative;
  width: fit-content;
  isolation: isolate;
}

/* star core */

.retro-star {
  width: 280px;
  height: 280px;

  border: none;

  image-rendering: pixelated;

  filter:
    contrast(1.8)
    saturate(2)
    brightness(1.15);

  animation:
    float 6s ease-in-out infinite,
    arcadePulse 1.8s infinite,
    arcadeJitter 0.12s infinite;
}

/* phosphor glow burst */

.retro-star-wrapper::before {
  content: "";
  position: absolute;
  inset: -20px;

  background: radial-gradient(
    circle,
    rgba(8,183,79,0.5),
    rgba(254,200,75,0.25),
    transparent 70%
  );

  filter: blur(20px);
  z-index: -1;

  animation: glowBurst 2.5s infinite;
}

/* CRT scanlines */

.crt-overlay {
  pointer-events: none;
  position: absolute;
  inset: 0;

  background: repeating-linear-gradient(
    to bottom,
    rgba(0,0,0,0.35) 0px,
    rgba(0,0,0,0.35) 2px,
    transparent 2px,
    transparent 5px
  );

  mix-blend-mode: overlay;
  opacity: 0.75;

  animation: crtFlicker 1.5s infinite;
}

/* animations */

@keyframes arcadePulse {
  0% { filter: contrast(1.8) saturate(2) brightness(1.1); }
  50% { filter: contrast(2.1) saturate(2.4) brightness(1.35); }
  100% { filter: contrast(1.8) saturate(2) brightness(1.1); }
}

@keyframes glowBurst {
  0% { opacity: 0.5; }
  50% { opacity: 0.9; }
  100% { opacity: 0.5; }
}

@keyframes crtFlicker {
  0% { opacity: 0.7; }
  50% { opacity: 1; }
  100% { opacity: 0.7; }
}

@keyframes arcadeJitter {
  0% { transform: translate(0,0); }
  25% { transform: translate(1px,-1px); }
  50% { transform: translate(-1px,1px); }
  75% { transform: translate(1px,1px); }
  100% { transform: translate(0,0); }
}

  </style>
{% endblock head %}
{% block content %}
  <div class="min-h-screen flex items-center justify-center px-4 pb-8 md:pt-4">
    <div class="max-w-4xl mx-auto py-10 px-6"
         data-aos="fade-up"
         data-aos-duration="800">
      <div class="text-center mb-12">
        <div class="pixel-accent mb-6 mx-auto" style="width: 200px;"></div>
        <h1 class="font-pixel text-3xl md:text-4xl text-gradient mb-4"
            data-aos="fade-up"
            data-aos-delay="200">Completed!</h1>
        <p class="retro-text text-xl text-light/80 max-w-2xl mx-auto"
           data-aos="fade-up"
           data-aos-delay="400">
          Congratulations! You've successfully completed the
          <br>
          <span class="font-pixel text-base text-primary crt-glow-sm">Re-Dcrypt Cryptic Hunt.</span>
        </p>
        <div class="retro-text text-light/60 mt-4"
             data-aos="fade-up"
             data-aos-delay="400">Please take a moment to fill out the feedback form below.</div>
        <div class="mt-6 flex justify-center"
        data-aos="fade-up"
        data-aos-delay="400">

      <button onclick="window.open('https://forms.fossbu.co/form/sVvK1ozU', '_blank')"
              class="font-pixel text-xs uppercase tracking-wide
                    border-4 border-secondary
                    bg-secondary/10 text-secondary
                    px-8 py-4 rounded
                    flex items-center gap-3
                    transition-all duration-150
                    hover:bg-secondary hover:text-dark
                    hover:-translate-y-1
                    shadow-[0_4px_0_rgba(254,200,75,0.4)]">

        <i class="ph-fill ph-star animate-pulse"></i>
        Feedback Form

      </button>

</div>

      </div>
      
      <!-- Celebration Video -->
      <div class="flex justify-center mb-12"
     data-aos="fade-up"
     data-aos-delay="600">

        <div class="retro-star-wrapper">

          <video class="celebration-video retro-star"
                autoplay
                loop
                muted
                playsinline>
            <source src="{% static 'videos/star.webm' %}" type="video/webm">
          </video>

          <div class="crt-overlay"></div>

        </div>

      </div>

      
      <!-- Stats -->
      <div class="flex justify-center gap-4 mb-12"
           data-aos="fade-up"
           data-aos-delay="800">
        <div class="stats-card p-6 text-center">
          <div class="flex items-center justify-center w-12 h-12 border-2 border-primary rounded bg-primary/10 text-primary mx-auto mb-4">
            <i class="ph-fill ph-trophy text-2xl"></i>
          </div>
          <h3 class="retro-text text-light/60 text-sm mb-2">Final Score</h3>
          <p class="font-pixel text-xl text-primary">{{ user.profile.score }}</p>
        </div>
        <div class="stats-card stats-card-secondary p-6 text-center">
          <div class="flex items-center justify-center w-12 h-12 border-2 border-accent rounded bg-accent/10 text-accent mx-auto mb-4">
            <i class="ph-fill ph-crown text-2xl"></i>
          </div>
          <h3 class="retro-text text-light/60 text-sm mb-2">Final Level</h3>
          <p class="font-pixel text-xl text-accent">{{ user.profile.current_level }}</p>
        </div>
      </div>
      
      <div class="pixel-accent-amber mx-auto" style="width: 200px;"></div>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/party-js@latest/bundle/party.min.js"></script>
  <script src="https://unpkg.com/tsparticles-engine/"></script>
  <script src="https://unpkg.com/tsparticles-slim/"></script>
  <script src="https://cdn.jsdelivr.net/npm/tsparticles-preset-fireworks@2/tsparticles.preset.fireworks.bundle.min.js"></script>
  <script>
party.confetti(party.Rect.fromScreen());
tsParticles.load("tsparticles", {
    "fullScreen": {
      "zIndex": 1
    },
    "particles": {
      "number": {
        "value": 0
      },
      "color": {
        "value": [
          "#08B74F",
          "#fec84b",
          "#f07a1a"
        ]
      },
      "shape": {
        "type": [
          "circle",
          "square",
          "triangle",
          "polygon"
        ],
        "options": {
          "polygon": [
            {
              "sides": 5
            },
            {
              "sides": 6
            }
          ]
        }
      },
      "opacity": {
        "value": 1,
        "animation": {
          "enable": true,
          "minimumValue": 0,
          "speed": 2,
          "startValue": "max",
          "destroy": "min"
        }
      },
      "size": {
        "value": 4,
        "random": {
          "enable": true,
          "minimumValue": 2
        }
      },
      "links": {
        "enable": false
      },
      "life": {
        "duration": {
          "sync": true,
          "value": 5
        },
        "count": 1
      },
      "move": {
        "enable": true,
        "gravity": {
          "enable": true,
          "acceleration": 10
        },
        "speed": {
          "min": 10,
          "max": 20
        },
        "decay": 0.1,
        "direction": "none",
        "straight": false,
        "outModes": {
          "default": "destroy",
          "top": "none"
        }
      },
      "rotate": {
        "value": {
          "min": 0,
          "max": 360
        },
        "direction": "random",
        "move": true,
        "animation": {
          "enable": true,
          "speed": 60
        }
      },
      "tilt": {
        "direction": "random",
        "enable": true,
        "move": true,
        "value": {
          "min": 0,
          "max": 360
        },
        "animation": {
          "enable": true,
          "speed": 60
        }
      },
      "roll": {
        "darken": {
          "enable": true,
          "value": 25
        },
        "enable": true,
        "speed": {
          "min": 15,
          "max": 25
        }
      },
      "wobble": {
        "distance": 30,
        "enable": true,
        "move": true,
        "speed": {
          "min": -15,
          "max": 15
        }
      }
    },
    "emitters": {
      "life": {
        "count": 0,
        "duration": 0.1,
        "delay": 0.4
      },
      "rate": {
        "delay": 0.1,
        "quantity": 150
      },
      "size": {
        "width": 0,
        "height": 0
      }
    }
}); 

document.addEventListener('DOMContentLoaded', () => {
    celebrateCompletion();
    setInterval(celebrateCompletion, 3000); 
});
  </script>
{% endblock content %}
